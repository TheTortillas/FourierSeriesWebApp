<div class="container mx-auto px-4 py-8">
    <div class="max-w-3xl mx-auto bg-white rounded-lg shadow-md p-6">
      <!-- Título -->
      <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">
        Calculadora de Series de Fourier
      </h1>
  
      <!-- Teclado Matemático -->
      <div class="flex flex-wrap justify-center mb-6">
        <button
          *ngFor="let btn of mathButtons"
          (click)="insertLatex(btn.latex)"
          [innerHTML]="btn.display"
          class="w-20 h-12 m-1 border border-gray-300 rounded-lg bg-gray-50 hover:bg-gray-200 transition-colors focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 flex items-center justify-center"
        >
        </button>
      </div>
  
      <!-- Función a trozos -->
      <div class="mb-6">
        <label class="text-2xl font-semibold text-gray-700 mb-4 block">Función $$ f(x): $$</label>
        <div #piecesContainer class="max-h-48 overflow-y-auto border border-gray-300 rounded-lg p-4 bg-gray-50">
          <div
            class="flex items-center gap-4 mb-3"
            *ngFor="let piece of pieces; let i = index; trackBy: trackByIndex"
          >
            <!-- Campo para la función -->
            <div
              class="math-field border border-gray-300 p-3 rounded-lg min-w-[4rem] cursor-text focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              #funcFieldElem
              (mousedown)="setActiveField(i, 'funcField')"
            ></div>
      
            <span class="mx-2 text-gray-700">,</span>
      
            <!-- Intervalo inicio -->
            <div
              class="math-field border border-gray-300 p-3 rounded-lg w-16 cursor-text focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              #startFieldElem
              (mousedown)="setActiveField(i, 'startField')"
            ></div>
      
            <span class="mathjax-text text-gray-700">$$< x <$$</span>
      
            <!-- Intervalo fin -->
            <div
              class="math-field border border-gray-300 p-3 rounded-lg w-16 cursor-text focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              #endFieldElem
              (mousedown)="setActiveField(i, 'endField')"
            ></div>
      
            <!-- Botones + y - -->
            <div class="flex items-center gap-2">
              <!-- El botón "+" solo aparece en el último elemento -->
              <button
                *ngIf="i === pieces.length - 1"
                class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
                (click)="addPiece()"
              >
                +
              </button>
              <!-- El botón "-" aparece en todos los elementos excepto cuando solo hay uno -->
              <button
                *ngIf="pieces.length > 1"
                class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors focus:ring-2 focus:ring-red-500 focus:ring-offset-2"
                (click)="removePiece(i)"
              >
                -
              </button>
            </div>
          </div>
        </div>
      </div>
  
      <!-- ComboBox de tipo de serie -->
      <div class="mb-6">
        <label for="type" class="text-xl font-semibold text-gray-700 mb-2 block">Elige el tipo de serie:</label>
        <select
          id="type"
          [(ngModel)]="selectedSeriesType"
          (change)="onTypeChange()"
          class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"
        >
          <option value="" disabled selected>Selecciona el tipo de Serie de Fourier</option>
          <option value="Trigonometric">Trigonométrica</option>
          <option value="Complex">Compleja</option>
        </select>
      </div>
  
      <!-- Toggle para extensión de medio rango -->
      <div class="mb-6 flex items-center" *ngIf="showHalfRangeToggle">
        <label for="toggleExtension" class="text-xl font-semibold text-gray-700 mr-4">¿Extensión de Medio Rango?</label>
        <input
          type="checkbox"
          id="toggleExtension"
          [(ngModel)]="useHalfRange"
          (change)="onToggleChange()"
          class="h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
        />
      </div>
  
      <!-- Opciones adicionales -->
      <div class="mb-6" *ngIf="showHalfRangeExtension">
        <label for="halfRange" class="text-xl font-semibold text-gray-700 mb-2 block">Elige la Extensión de Medio Rango:</label>
        <select
          id="halfRange"
          [(ngModel)]="selectedHalfRange"
          class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"
        >
          <option value="" disabled selected>Elige el tipo de extensión</option>
          <option value="Even">Extensión Par (Serie de Coseno)</option>
          <option value="Odd">Extensión Impar (Serie de Seno)</option>
          <option value="Periodic">Extensión Periódica (Serie de Coseno y Seno)</option>
        </select>
      </div>
    </div>
  </div>